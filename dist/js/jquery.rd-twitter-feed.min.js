/**
 * @module       jQuery RD Twitter Feed
 * @author       Rafael Shayvolodyan (raffa)
 * @version      1.0.5
 */
(function(){(function(k,p,q){return function(){function h(a,c){this.options=k.extend(!0,{},this.Defaults,c);this.$element=k(a);this.initialize()}h.prototype.Defaults={username:"templatemonster",list:null,hashtag:null,hideReplies:!0,dateFormat:"%b/%d/%Y",apiPath:"bat/twitter_api/tweet.php",loadingText:"Loading...",localTemplate:{message:"This is sample tweet for local testing. Upload your project to the live hosting server for get data from twitter.com",serverMessage:"RD Twitter Feed: Please upload project to the server for enable plugin!",
user_name:"TemplateMonster",date:"Fri Nov 06 11:20:43 +0000 2015",tweet:"Check Out NEW #Photographer Portfolio Responsive Photo - goo.gl/ECjPvq",avatar:"http://pbs.twimg.com/profile_images/611164752396419072/hJYLqLJR_normal.jpg",url:"https://twitter.com/templatemonster/status/660069673464160256",screen_name:"@templatemonster",media_url:["https://pbs.twimg.com/media/CS6HxzwUEAALx0y.jpg","http://pbs.twimg.com/media/CShUCIYUcAABb53.jpg"]},dateText:{seconds:"less 1m",minutes:"m",hours:"h",yesterday:"yd"},
callback:!1};h.prototype.initialize=function(){var a=this.$element;this.options.list&&!this.options.username&&console.error("If you want to fetch tweets from a list, you must define the username of the list owner.");if(this.isLocal())a.prepend("<h6>"+this.options.localTemplate.message+"</h6>");else if(!this.isServer()){a.prepend("<h6>"+this.options.localTemplate.serverMessage+"</h6>");return}a.append('<span id="loading_tweet">'+(a.attr("data-twitter-loading")?a.attr("data-twitter-loading"):this.options.loadingText+
"</span>"));this.fetch()};h.prototype.linking=function(a,c){var d,b;var e=a.replace(/#([a-zA-Z0-9_]+)/g,'<a href="https://twitter.com/search?q=%23$1&amp;src=hash" target="_blank" title="Search for #$1">#$1</a>').replace(/@([a-zA-Z0-9_]+)/g,'<a href="https://twitter.com/$1" target="_blank" title="$1 on Twitter">@$1</a>');var g=a.match(/(https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w\/_\.]*(\?\S+)?)?)?)/ig);if(null!==g){var f=0;for(d=g.length;f<d;f++){var h=g[f];var k=c.entities.urls;var l=0;for(b=k.length;l<
b;l++){var n=k[l];e=e.replace(h,'<a href="'+n.expanded_url+'" target="_blank">'+n.display_url+"</a> ")}e=e.replace(h,"")}}return e};h.prototype.dating=function(a,c){var d;var b=a.split(" ");a=new Date(Date.parse(b[1]+" "+b[2]+", "+b[5]+" "+b[3]+" UTC"));var e=((new Date).getTime()-a.getTime())/1E3;b="January February March April May June July August September October November December".split(" ");b={"%d":a.getDate(),"%m":a.getMonth()+1,"%b":b[a.getMonth()].substr(0,3),"%B":b[a.getMonth()],"%y":String(a.getFullYear()).slice(-2),
"%Y":a.getFullYear()};var g=c?"%Y-%m-%d":this.$element.attr("data-twitter-date-format")?this.$element.attr("data-twitter-date-format"):this.options.dateFormat;if(60>e)return this.$element.attr("data-twitter-date-seconds")?this.$element.attr("data-twitter-date-seconds"):this.options.dateText.seconds;if(60>e/60)return Math.round(e/60)+(this.$element.attr("data-twitter-date-minutes")?this.$element.attr("data-twitter-date-minutes"):this.options.dateText.minutes);if(24>e/60/60)return Math.round(e/60/60)+
(this.$element.attr("data-twitter-date-hours")?this.$element.attr("data-twitter-date-hours"):this.options.dateText.hours);if(2>e/60/60/24)return this.$element.attr("data-twitter-date-yesterday")?this.$element.attr("data-twitter-date-yesterday"):this.options.dateText.yesterday;var f=g.match(/%[dmbByY]/g);var h=0;for(d=f.length;h<d;h++)e=f[h],g=g.replace(e,b[e]);return g};h.prototype.isLocal=function(){var a;var c=["127.0.0.1","192.168","localhost"];var d=0;for(a=c.length;d<a;d++){var b=c[d];if(-1<
p.location.hostname.indexOf(b))return!0}return!1};h.prototype.isServer=function(){var a=q.location.href;return-1<a.indexOf("http://")||-1<a.indexOf("https://")?!0:!1};h.prototype.getMedia=function(a){var c;if(a.extended_entities){if(a.extended_entities.media){var d=[];var b=a.extended_entities.media;var e=0;for(c=b.length;e<c;e++)a=b[e],d.push(a.media_url);return d}}else return a.entities&&a.entities.media?a.entities.media[0].media_url:null};h.prototype.getTempData=function(a,c){var d;var b=a.$element.find('[data-twitter-type="tweet"]').length;
var e=[];if(a.isLocal())for(d=0;0<=b?d<b:d>b;0<=b?++d:--d){var g={user_name:a.options.localTemplate.user_name,date:a.dating(a.options.localTemplate.date,!1),datetime:a.dating(a.options.localTemplate.date,!0),tweet:a.linking(a.options.localTemplate.tweet),avatar:a.options.localTemplate.avatar,url:a.options.localTemplate.url,retweeted:!1,screen_name:a.linking(a.options.localTemplate.screen_name),media_url:a.options.localTemplate.media_url};e.push(g)}else for(g=d=0;0<=b?d<b:d>b;g=0<=b?++d:--d){if(c[g])var f=
c[g];else if(c.statuses&&c.statuses[g])f=c.statuses[g];else break;g={user_name:f.user.name,date:a.dating(f.created_at,!1),datetime:a.dating(f.created_at,!0),tweet:a.linking(f.text,f),avatar:f.user.profile_image_url,url:"https://twitter.com/"+f.user.screen_name+"/status/"+f.id_str,retweeted:f.retweeted,screen_name:a.linking("@"+f.user.screen_name,f)};g.media_url=a.getMedia(f);e.push(g)}return e};h.prototype.fetch=function(){var a=this.$element;k.getJSON(this.options.apiPath,{username:a.attr("data-twitter-username")?
a.attr("data-twitter-username"):this.options.username,list:a.attr("data-twitter-listname")?a.attr("data-twitter-listname"):this.options.list,hashtag:a.attr("data-twitter-hashtag")?a.attr("data-twitter-hashtag"):this.options.hashtag,count:a.find('[data-twitter-type="tweet"]').length+1,exclude_replies:this.options.hideReplies},k.proxy(function(c){a.find("#loading_tweet").fadeOut("fast");this.construct(this.getTempData(this,c))},this));"function"===typeof this.options.callback&&this.options.callback()};
h.prototype.construct=function(a){var c,d;var b=this;var e=b.$element.find('[data-twitter-type="tweet"]');var g=c=0;for(d=e.length;0<=d?c<d:c>d;g=0<=d?++c:--c){"A"===e.prop("tagName")&&this.tweetLink(e.eq(g),a[g]);var f=0;e.eq(g).find("*").each(function(){b.parseAttributes(this,a[g],f);this.hasAttribute("data-media_url")&&f++});e.css("opacity","1")}};h.prototype.tweetLink=function(a,c){a.attr("href",c.url)};h.prototype.parseAttributes=function(a,c,d){var b,e;var g=k(a);var f=g.data();for(b in f)if((f[b]||
"xImage"!==f[b]&&"xId"!==f[b])&&f.hasOwnProperty(b)&&"string"===typeof f[b]){var h=f[b].split(/\s?,\s?/i);var m=0;for(e=h.length;m<e;m++){var l=h[m];"data-x-id"!==l&&"data-x-image"!==l&&("text"===l.toLowerCase()?a.innerHTML=c[b]:"media_url"===b?k.isArray(c[b])&&c[b].length>d?a.setAttribute(l,c[b][d]):null!==c[b]&&0===d?a.setAttribute(l,c[b]):g.remove():a.setAttribute(l,c[b]))}}};k.fn.extend({RDTwitter:function(a){this.each(function(){});var c=k(this);if(!c.data("RDTwitter"))return c.data("RDTwitter",
new h(this,a))}});return h}()})(window.jQuery,document,window);"undefined"!==typeof module&&null!==module?module.exports=window.RDTwitter:"function"===typeof define&&define.amd&&define(["jquery"],function(){return window.RDTwitter})}).call(this);